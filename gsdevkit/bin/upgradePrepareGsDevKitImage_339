set -e
. defStone.env
export vers="3.5.0_g"

rm -f *.log *.out

# createStone -g battery_339 3.3.9

sourceStoneName="battery_339"
stopStone $sourceStoneName
stopStone $GEMSTONE_NAME

newExtent -s snapshots/extent0_upgradeImage_339.dbf $GEMSTONE_NAME

export upgradeLogDir=`pwd`/upgradeLogDir

startStone -b -w 5 $GEMSTONE_NAME

pushd "${upgradeLogDir}" >& /dev/null
  # start standard upgrade
	rm -f *.log *.out
  echo "STARTING standard upgradeImage "
	startTopaz $GEMSTONE_NAME -lq < $GS_HOME/shared/repos/GsDevKit_upgradeDevKitImage/bin/installGsDevKit_upgrade_339
	startTopaz $GEMSTONE_NAME -lq < $GS_HOME/shared/repos/GsDevKit_upgradeDevKitImage/bin/prepareGsDevKitImage
	startTopaz $GEMSTONE_NAME -lq < $GS_HOME/shared/repos/GsDevKit_upgradeDevKitImage/bin/prepareGsDevKitImage_user
	startTopaz $GEMSTONE_NAME -lq < $GS_HOME/shared/repos/GsDevKit_upgradeDevKitImage/bin/runImageTests
popd

# stopStone $GEMSTONE_NAME
# cp extents/extent0.dbf snapshots/extent0_preparedGsDevKitImage_339.dbf

